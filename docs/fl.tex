\documentclass{sig-alternate}
\usepackage{url}

\title{FriendlyLocation: User Location Estimation Based on the Social Graph}

\numberofauthors{1} 
\author{
    \alignauthor Jeffrey McGee, James Caverlee\\
    \affaddr{Department of Computer Science and Engineering, Texas A\&M
    University} \\
    \affaddr{ College Station, TX 77845 USA} \\
    \email{jeffamcgee@tamu.edu, caverlee@cse.tamu.edu}
} 
\begin{document}

\maketitle
\begin{abstract}
We investigate the relationship between the stregth of the connection between a pair of users, and the distance between the pair.
We use what we have observed about the edges of the social graph to improve a location estimation system.

goal: estimate location of users on twitter
special sauce: people live near friends, some relationships are more important than others
\end{abstract}




\section{INTRODUCTION}


\section{RELATED WORK}


\section{DATA COLLECTION}
\subsection{houston}
snowball sample starting from a handful of users done in November 2010
visited @mentioned users and rfriends
Took everyone who geocoded to Houston, plus users with two out of three:
    high connectedness using score,
    central standard time,
    unknown location field
Ignored accounts that were protected
160k users - 80k definite, 80k probable


\subsection{Data from Twitter}
We used Twitter's Streaming API to obtain tweets that contain geographic information.
We used 19877804 tweets posted between April 7 until April 16,2011.
We ignored tweets from users who made their account private, had neither friends nor followers, or posted fewer than two tweets.
We found the median latitude and median longitude for each user, and use this as an approximation of the home location of the user.
We noticed that some Twitter accounts, such as accounts that posted jobs, would move around faster than a human could possibly move. To account for this, we calculated the distance beteen each tweet and the user's home location. We ignored users if the median distance from their tweets to their home location was greater than 50 miles.

We divided these geo-located users into three groups based on the last digit of their twitter user id:
\begin{description}
\item[0--3] 131295 users from around the world with a decodable location field to estimate the quality of results from the reverse geocoder.
\item[4--6] 40945 users with a home location in the US bounding box to train FriendlyLocation.
\item[7--9] 40861 users, also in the US, to evaluate FriendlyLocation.
\end{description}


We considered users to be in the US based on a simple bounding box.  If their median latitude was between 24 and 50 degrees and their median longitude was between -126 and -66 degrees, then their home location was considered inside the continental US.
For all of the geo-located users who lived in the US, we used Twitter's API to download the users' friends, followers, and 100 most recent tweets. We also downloaded the profiles for 100 randomly chosen friends, followers, and people they mention in their tweets.
From the 100 profiles, we kept the users with a decodable locaion field and threw away the rest. From what was left of the hundred, we randomly picked one relationship from each of these four categories:
\begin{description}
\item[reciprical friend (rfrd)] The geo-located user follows this user and is followed back.
\item[just friend (jfrd)] The geo-located user follows this user and is not followed back.
\item[just follower (jfol)]The geo-located user is followed by this user, but does not follow them.
\item[just mentioned (jat)] The users do not follow each other, but the geo-located user mentioned the name of the other user in a tweet.
\end{description}
For each relationship, we stored their friends, followers, and 100 most recent tweets.

\subsection{Reverse Geocoding}
We used gisgraphy to do reverse geocoding. Gisgraphy does full-text search on the GeoNames database, and runs locally, which means we are not limited to a certain number of queries per day.

The location field on a user's profile is just a text field that asks the user to respond to "Where in the world are you?". Repsonses vary from latitude and longitude coordinates to geographical regions to jokes and nonsense. Often, the geocoder found reasonable locations for meaningless locations such as "mars".
We noticed that some locations are significantly more useful than others. For example, even thogh Rhode Island and Montana are both states with aronud one million people, Rhode Island is smaller, and as a result, much more useful in estimating the location of a user.

To make the results of the geocoder more useful, we used a portion of the 

\section{INVESTIGATION}

All of the analysis in this section of this document was done on 104214 users with a home location inside the US bounding box, and in the first two groups of users (the last digit of their user id was between 0 and 6).

What type of friendship is closest?

What is the relationship between friendship and distance?
mixed social network and news network
some connections are based on 

Are you closer to people you commmunicate with?















analysis of Houston:
most users stay within 8 miles of home
users tweet along roadways
geolocoated tweets show map starting at houston expanding out
looked at triangles posting distance of two sides on x-y axis
strong concentration at 0,0
compared fake triangles to real triangles:
    real triangles have high concentration near origin
    fake triangles spread out
%hou_gis: where locations tend to resolve to
Since people often say they live in a city, there are large clusters.

For houston, I picked a friend for each user and went from there.
In houston data, having stars in common hurts the chances that two users are nearby.  It doesn't matter for the geo data. In Houston, we are only looking at up to 100 miles. Does this matter?


%normed_edges.png:
conv>ated>at>rfrd>fol>frd>random
why is rfrd so close to fol in the hou data? Because we know they live near eachother?

%tpu_hist: tweets per user is zipfian

%diff_gnp_gps.png - shows the error in gnp decoding by comparing it to normal tweets

%tri_deg_*.png - The number of triangles formed is NOT a function of the number of edges a user has therefore talking about the ratio of people involved in a type of triangle is stupid.

%geo_edges_log.png - same as normed_edges.png

%geo_tri_rfrd_sp.png - distance is a binomial distribution, possibly the sum of two log-normal distributions.

%geo_local_1_*.png when you take out non-locals the cumulative graph starts to look linear.

%geo_local_*.png - after removing the non-local, you still see a hump around 10 miles. Is that just error from the geo-coding and city level data?

%local_ratio.png - star v. non-star matters a lot for friend case, but not so much in others
\section{EVALUATION}
\section{FUTURE WORK}

\bibliographystyle{abbrv}
\bibliography{fl} 
\end{document}
